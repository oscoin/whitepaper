\section{The Oscoin Network}
\label{s:oscoin}

% Objectives
% ==========
% * Describe how oscoin works
% * Explain how money flows to the most valuable projects
% * Explain how this solves the sustainability problem
% * Explain how we tie money with OSS / how we link money with the dependency graph

% TODO: Diagram that shows Dependencies -> SrcRank -> Block reward -> Distribution

\noindent In this paper, we introduce \oscoin{}, a protocol and currency
designed to provide a solution to the open source sustainability problem.

The \oscoin{} network is a public network of computers operating a distributed
consensus protocol around a transaction ledger.

% TODO: Move formalities and mathematical notation to after the 'overview';
% i.e. make this lighter.

This ledger is materialized into a shared state $\state$ which
contains the canonical registry $\mathcal{R}$ of all open source
projects participating in the \oscoin{} protocol; a set of accounts
$\mathcal{A}$, containing the balances of all currency holders; and
finally a network graph $\netgraph$, of relevant relations between
entities in the network, including in particular dependencies between
registered projects.
% TODO: Registry letter is wrong

The purpose of this network is to secure a digital currency---\oscoin{}---and
reward the most valued open source projects in the network, without the need
for intermediaries or central control.

\subsection{The Oscoin Blockchain}

% TODO: Is the notation introduced here used anywhere else? At the moment the
% 'transactions' section is rather loose. I think either we make the ledger
% section more formal in terms of $\state$, etc. or we drop the notation here.

The \oscoin{} network is composed of a set of nodes, or \emph{replicas}, which
execute a distributed protocol. Together, these nodes form a \emph{Replicated
  State Machine} with a set of states $\state$, a transition function $\Xi$,
a starting state $\state_0$ or ``genesis'', a set of inputs $B_0, \ldots, B_n$,
and a set of outputs.

To allow for the creation of a safe, open (``permissionless'') currency shared
amongst all network participants, we use a blockchain protocol, as described by
Nakamoto in \cite{bitcoin} and Wood in \cite{ethereum}.

Though the specific choice of the underlying consensus mechanism is not
directly relevant to \oscoin{}, we believe that one which allows open
participation is best for the long term health of the network. Furthermore,
it's important that reliable support for light clients be possible. The only
family of blockchain protocols with these characteristics are the proof-of-work
protocols.

The inputs $B_0, \ldots, B_n$ to the state machine are therefore blocks, with
$B_0$ being the genesis block.

% TODO: Hashing function?

\begin{figure*}[!ht]
    \par\medskip\noindent\minipage{\linewidth}
    \centering
    \input{figures/oscoin.tikz}
    \caption{Oscoin Monetary Policy\label{f:oscoin}}
    \endminipage\par\medskip
\end{figure*}

\subsection{The Oscoin Treasury}
\label{s:treasury}
% TODO: ^ Revisit this name from a brand perspective

The treasury subsystem is designed to continuously rank projects on the
network based on relative importance, and reward them with \oscoin{}.

\subsubsection{Overview}

\begin{itemize}
    \item Maintainers and contributors collaborate around software projects
        registered on the network.
    \item Maintainers merge contributions and synchronize their project state
        with the ledger, which includes per-project dependency information and
        contribution metadata (\S\ref{s:checkpointing}).
    \item Every $\epoch$ blocks, projects have their \osrank{} score calculated
        (\S\ref{s:osrank}).
    \item A reward in \oscoin{} is derived from each project's \osrank{},
        and distributed to \emph{projects and contributors} through smart
        contracts (\S\ref{s:smart-contracts}).
\end{itemize}

\medskip

\noindent Each block, the protocol is allowed to mint a certain amount $B_r$ of \oscoin{}
(the ``block reward''), as part of what we call the \emph{coinbase}
transaction. These coins are allocated to two distinct groups: network
operators (``miners''), formally $\miners$, and open source projects ($\projs$)
through the treasury system.

The key question we must answer, is what share of $B_r$ is distributed to
individual projects and contributors in the network.  The goal is to choose
a distribution mechanism that rewards projects in proportion to their relative
importance within the network, or \emph{merit}.

% TODO: We don't talk about value capture at all

For this, we leverage the \oscoin{} network graph $\netgraph$ (Section
\ref{s:netgraph}), which maps flows of value between projects and contributors,
and assigns a weight to each.

\subsubsection{Algorithm} Let $t$ be the total amount of \oscoin{} distributed
to $n$ projects every epoch $\epoch$. The amount $t_P$ distributed to a given
project $P$ over $\epoch$ is a function of its \osrank{} weight $\omega(P)$,
which rewards higher ranking projects with more \oscoin{}. We describe this
\emph{payment function} as
\[
    \psi(t, \omega(P)) \to t_P
\]
To prevent trivial Sybil attacks from succeeding, the payment function takes
into account a minimum threshold for $\omega(P)$ under which a project doesn't
receive anything. Rewards can be further equalized by tweaking $\psi$ to
compress or expand the range of rewards.

With this model, itâ€™s the responsibility of maintainers to choose project
dependencies well and to maintain their stated dependencies up to date, since
by depending on a project, they are casting a vote for that dependency to
receive money.  This is amplified for highly-weighted projects in the graph.

At scale, this mechanism has the potential to solve many of the issues with
open source monetization and sustainability, as software projects receive
income in the form of \oscoin{}, while licensing their work as free and
open source software (FOSS). This continuous algorithmic funding model moves
away from current ``transactional'' models which require open source projects
to change the way they work, re-license, or setup a business.
