\section{The Oscoin Network}
\label{s:oscoin}

% Objectives
% ==========
% * Describe how oscoin works
% * Explain how money flows to the most valuable projects
% * Explain how this solves the sustainability problem
% * Explain how we tie money with OSS / how we link money with the dependency graph

% TODO: Diagram that shows Dependencies -> SrcRank -> Block reward -> Distribution

\noindent In this paper, we introduce \oscoin{}, a protocol and currency
designed to provide a solution to the open source sustainability problem (\S
\ref{s:sustainability}).

The \oscoin{} network is a public network of computers operating a distributed
consensus protocol around a transaction ledger.

% TODO: Move formalities and mathematical notation to after the 'overview';
% i.e. make this lighter.

This ledger is materialized into a shared state $\state$ which
contains the canonical registry $\mathcal{R}$ of all open source
projects participating in the \oscoin{} protocol; a set of accounts
$\mathcal{A}$, containing the balances of all currency holders; and
finally a network graph $\netgraph$, of relevant relations between
entities in the network, including in particular dependencies between
registered projects.

The purpose of this network is to secure a digital currency---\oscoin{}---and
its monetary policy which rewards the most valued open source projects in the
network, without the need for intermediaries or central control.

\subsection{Overview}

\begin{itemize}
    \item Maintainers and contributors collaborate around software projects
        registered on the network.
    \item Maintainers specify what other projects their projects depend on.
    \item Every $n$ blocks, projects have their \osrank{} calculated, and a
        token reward is calculated for each, in proportion to their rank.
    \item The rewards are sent to the given projects.
    % TODO: We need to talk about smart-contracts somewhere else in the paper.    
    \item Projects are able to use the funds how they see fit. \emph{Smart
        contracts} are used as a means for distribution of tokens from within a
        project, to its constituent members or contributors.
\end{itemize}

\subsection{The Oscoin Blockchain}

% TODO: Is the notation introduced here used anywhere else? At the moment the
% 'transactions' section is rather loose. I think either we make the ledger
% section more formal in terms of $\state$, etc. or we drop the notation here.

The \oscoin{} network is composed of a set of nodes, or \emph{replicas}, which
execute a distributed protocol. Together, these nodes form a \emph{Replicated
  State Machine} with a set of states $\state$, a transition function $\apply$,
a starting state $\state_0$ or ``genesis'', a set of inputs $B_0, \ldots, B_n$,
and a set of outputs.

To allow for the creation of a safe, open (``permissionless'') currency shared
amongst all network participants, we use a blockchain protocol, as described by
Nakamoto in \cite{bitcoin} and Wood in \cite{ethereum}.

Though the specific choice of the underlying consensus mechanism is not
directly relevant to \oscoin{}, we believe that one which allows open
participation is best for the long term health of the network. Furthermore,
it's important that reliable support for light clients be possible. The only
family of blockchain protocols with these characteristics are the proof-of-work
protocols. We thus settle on Nakamoto~\cite{bitcoin} consensus.

The inputs $B_0, \ldots, B_n$ to the state machine are therefore blocks, with
$B_0$ being the genesis block.

% TODO: Hashing function?

\begin{figure*}[!ht]
    \par\medskip\noindent\minipage{\linewidth}
    \centering
    \input{figures/oscoin.tikz}
    \caption{Oscoin Monetary Policy\label{f:oscoin}}
    \endminipage\par\medskip
\end{figure*}

\subsection{Monetary Policy}

Each block, the protocol is allowed to mint a certain amount $B_r$ of \oscoin{}
(the ``block reward''), as part of what we call the \emph{coinbase}
transaction. These coins are divided into two shares, the first serving as a
reward to the block miner, while the second is used to supply the reward
mechanism for open-source projects.

\subsubsection{Token distribution}

The key question we must answer, is how the block reward is distributed to
projects on the network.

The goal is to choose a distribution mechanism that benefits the network as a
whole, while needing the least amount of maintenance.

For this, we turn to the network graph $\netgraph$, which includes in
particular the graph of dependencies between projects.

Each project registered in the network is required to specify which other
projects it depends on. For example, a web framework might depend on an HTTP
library, and that HTTP library might depend on an OpenSSL implementation.

% TODO: The following 2 paragraphs feel a bit to much like details in this
% section: registration is covered in Ledger section, and dishonest deps should
% be dealt with at length somewhere else.
Registering a project requires a small deposit. This is to prevent the ledger
from being filled with abandonned projects, and because projects can influence
reward distribution through the dependency graph. This also makes Sybil attacks
and spam costly to attackers.

Still, it's possible that project maintainers act dishonnestly, by lying about
their dependencies. We propose a way to mitigate this in \S \ref{s:osrank}.

% TODO: 'epoch' is undefined at this point.
\subsubsection{Algorithm} Let $T$ be the amount of \oscoin{} to be distributed
to $N$ projects every epoch. The amount $T_P$ distributed to a given project $P$
is in proportion to its \osrank{}. \osrank{}, described in \S \ref{s:osrank} is
a centrality measure that assigns a weight $\omega(P)$ to each project by
following links in the network graph $\netgraph$.

The amount of tokens received every epoch by $P$ is governed by the
\emph{payment function} $\psi(T, \omega(P), \field{P}{stake})$, where
$\field{P}{stake}$ is the amount of \oscoin{} that is staked behind a project by
the community (see \S ref{s:staking}). The payment function takes into account a
minimum threshold, under which the project doesn't receive anything. This
threshold prevents small attacks from succeeding, while also concentrating the
rewards.

With this model, itâ€™s the responsibility of a project to choose its
dependencies well and to maintain its stated dependencies up to date, since by
depending on a project, it is casting a vote for that project to receive money.
This is amplified for highly-weighted projects in the graph.

% TODO: the first 2 sentences of this paragraph are a bit redundant.
The model we described distributes tokens on a continuous basis to the projects
most valued by the network. It does so by periodically minting new \oscoin{}
that it distributes according to the \osrank{} metric. At scale, this has the
potential to solve many of the issues with open source monetization and
sustainability, as software projects receive income in the form of \oscoin{}
by giving away their work for free.

% TODO: Explain how this is non-transactional and you don't have to change the
% way you work.
